<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Amigo Secreto</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="main-container">
    <h1>Amigo Secreto</h1>
    <div class="input-group">
        <label for="nameInput">Digite seu nome:</label>
        <input type="text" id="nameInput" placeholder="Nome">
        <button onclick="submitName()">Enviar</button>
    </div>

    <div class="counters">
    <div id="chocolateCount">Chocolatesüç´: 0</div>
    <div id="moneyCount">Dinheiroüí∞: $0</div>
</div>


    <div id="successMessage" class="success-message hidden">Boaaa, ja ta na lista!!!</div>


    <div class="participants-section">
        <h2>Participantes</h2>
        <table id="participantsTable">
            <tr>
                <th>Nome</th>
                <th>Data e Hora</th>
            </tr>
            <!-- Os participantes ser√£o inseridos aqui -->
        </table>
    </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

 const firebaseConfig = {
  apiKey: "AIzaSyDXOqm52mwBr4RH3KuP5MrGeyYg1qQy27M",
  authDomain: "amigo-secreto-8b3ae.firebaseapp.com",
  databaseURL: "https://amigo-secreto-8b3ae-default-rtdb.firebaseio.com",
  projectId: "amigo-secreto-8b3ae",
  storageBucket: "amigo-secreto-8b3ae.appspot.com",
  messagingSenderId: "133611460498",
  appId: "1:133611460498:web:2641aafc8c318aaa4d134b"
};


  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

window.submitName = function() {
    const nameInput = document.getElementById('nameInput');
    const name = nameInput.value.trim(); // Remove espa√ßos em branco no in√≠cio e no final
    const dateTime = new Date().toISOString();
    const successMessage = document.getElementById('successMessage');

    if (name === '') {
        // Exibe uma mensagem de erro se o campo estiver vazio
        alert('Por favor, insira seu nome.');
        return; // N√£o envia os dados se o campo estiver vazio
    }

    push(ref(database, 'participants'), {
        nome: name,
        data_hora: dateTime
    }).then(() => {
        // Mostra a mensagem de sucesso
        successMessage.classList.remove('hidden');
        successMessage.classList.add('visible');

        // Oculta a mensagem de sucesso ap√≥s 2 segundos
        setTimeout(() => {
            successMessage.classList.remove('visible');
            successMessage.classList.add('hidden');
        }, 15000);
    });

    nameInput.value = ''; // Limpa o campo de entrada
}



onValue(ref(database, 'participants'), (snapshot) => {
    const participantsTable = document.getElementById('participantsTable');
    
    // Inicializa contadores
    let chocolateCount = 0;
    let moneyCount = 0;

    participantsTable.innerHTML = `
        <tr>
            <th>Nome</th>
            <th>Data e Hora</th>
        </tr>
    `;
    
    snapshot.forEach((childSnapshot) => {
        const childData = childSnapshot.val();
        const row = participantsTable.insertRow(-1);
        const cellName = row.insertCell(0);
        const cellDate = row.insertCell(1);
        
        cellName.textContent = childData.nome;
        cellDate.textContent = formatDateTime(childData.data_hora);

        // Incrementa os contadores
        chocolateCount += 1;
        moneyCount += 10;
    });

    // Atualiza os elementos do contador
    document.getElementById('chocolateCount').textContent = `Chocolatesüç´: ${chocolateCount}`;
    document.getElementById('moneyCount').textContent = `Dinheiroüí∞: $${moneyCount}`;
});


// Formata a data e hora para um formato mais leg√≠vel (24 horas)
function formatDateTime(isoString) {
  const options = { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
  return new Date(isoString).toLocaleDateString('pt-BR', options);
}




</script>

</body>
</html>
